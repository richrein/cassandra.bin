#!/usr/bin/env bash

#
# Simple network bandwidth test
#

export thisCommand=`basename $0`

if [ x"$1" == x ]; then
	echo "Error: missing remote user@hostname"
	echo "Usage: $thisCommand file"
	exit 1
else
	remoteLogin="$1"; shift
fi

blockSize=1024
blockCount=10000
#blockCount=1000000

set -x
ssh -o "Compression no" "$remoteLogin" cat /dev/urandom | time dd of=/dev/null bs=$blockSize count=$blockCount
cat /dev/urandom | ssh -o "Compression no" "$remoteLogin" time dd of=/dev/null bs=$blockSize count=$blockCount
